PHASE 2.1 – Visual wiring + VIP locks + Upsell

الهدف: إظهار كل عناصر الواجهة بصريًا (الهيدر العلوي للطرف الثاني، ميتاداتا الطرف الثاني أسفل اليسار، عناصر أعلى يمين القسم السفلي، وشريط الأدوات)، وتفعيل الأقفال للمستخدم غير-VIP مع نافذة Upsell، والتأكد من عمل القوائم المنسدلة (الجنس/الدول) فوق كل الطبقات.

1) أقفال VIP (تظهر الخيارات لكن مقفلة)

في src/components/GenderFilter.tsx:

لغير VIP (عند !isVip && !FREE_FOR_ALL): اترك كل الخيارات مرئية، وأضف أيقونة قفل صغيرة بجانب كل خيار ≠ All.

عند النقر على خيار مقفول: لا تغيّر الحالة، بل استدعِ emit('ui:upsell','gender') مع Toast “هذه الميزة للمشتركين VIP”.

حد VIP: حتى خيارين مع عدّاد؛ تجاوز الحد → Toast “الحد الأقصى 2”.

في src/components/CountryFilter.tsx:

لغير VIP: اسمح فقط بـ All (أو بلد المستخدم التلقائي) وباقي الدول تظهر باهتة مع قفل.

عند محاولة اختيار دولة أخرى → emit('ui:upsell','countries').

حد VIP: حتى 15 دولة مع عدّاد؛ تجاوز الحد → Toast.

في أزرار مدفوعة أخرى:

Prev, Masks, Friends, والرسائل للمجاني ≥15: عند محاولة الاستخدام مع عدم الأهلية → emit('ui:upsell','feature-id') + Toast مناسب.

استخدم نفس UpsellModal الموجود لدينا، وإن لم يكن ظاهرًا، اربطه بحدث ui:upsell (نوع الميزة يحدد نص المحتوى).

2) ظهور القوائم المنسدلة فوق كل شيء

ارفع z-index للقوائم إلى 80+.

عالج أي overflow: hidden في حاوية الفيديو العلوية/السفلية.

إن لزم، اعمل Portal إلى document.body لقائمة الدول والجنس حتى لا تُقصّ بصريًا.

3) توزيع العناصر البصرية (كما طُلِب)

القسم العلوي (الطرف الثاني):

أعلى اليسار: بطاقة صغيرة تحتوي (أفاتار الطرف الثاني + الاسم + شارة VIP + ❤ وعدّاد إعجاباته).

أسفل اليسار: شرائح (chips) لبلده/مدينته/جنسه (ديناميكية وتتبدل مع كل مطابقة).

القسم السفلي (أنا/الطرف الأول):

أعلى اليمين: حاوية صغيرة تضم:

زر تبديل الكاميرا 🔄

زر تجميل ✨ (فعلي للتشغيل/الإيقاف)

❤ وعدّاد إعجاباتي (يُقرأ من API أو مؤقتًا من localStorage, ويُحدّث بحدث ditona:likes:update)

شريط الأدوات (أسفل): من اليمين لليسار:

Next (أكبر زر)

كتم صوت الطرف الثاني 🔈 (حالة تفاعلية)

مايك 🎙️ (تشغيل/كتم لمسار الصوت المحلي)

Like ❤ (toggle + حالة إن كنت معجبًا سابقًا)

Masks 🤡 (VIP gate)

Settings ⚙️ (يفتح /settings)

إيقاف/تشغيل ⏯️ (يوقف/يستأنف المطابقة بصريًا)

Report 🚩 (يرسل بلاغًا خفيفًا ثم Next)

Prev ◀ (VIP gate مع محاولة 7 ثوانٍ ثم توست “لم نجد المتصل السابق، انتقلنا لمطابقة جديدة”)

4) الإيماءات

أبقِ السحب يمين→يسار = Next، ويسار→يمين = Prev.

حساسية 60px. أضف Toast صغير عند التفعيل.

5) تجميل الوجه (تحسين ملحوظ)

فعّل وضع Skin smoothing حقيقي (MediaPipe FaceMesh أو Blur mask) بدل تغيير لون بسيط.

عند التفعيل أظهر مؤشر “Beauty ON” صغير أعلى اليمين (القسم السفلي).

إن كانت القدرة ضعيفة، اجعل الإعداد “Low/Med/High” داخليًا واختر “Med” كافتراضي.

6) اختبارات قبول (يجب تمريرها بصريًا)

القوائم المنسدلة للجنس/الدول تفتح فعليًا وتظهر فوق كل الطبقات.

لغير VIP: تظهر القفل على العناصر المقفلة، والنقر يفتح Upsell ولا يغيّر الحالة.

أماكن العناصر:

أعلى يسار العلوي = بطاقة الطرف الثاني (اسم/أفاتار/VIP/❤).

أسفل يسار العلوي = بلد/مدينة/جنس الطرف الثاني.

أعلى يمين السفلي = 🔄 ✨ ❤ (الخاصة بي).

شريط الأدوات يعمل: Next/Prev/Like/Mic/Mute/Masks/Settings/Stop/Report.

السحب يمين/يسار يعمل ويظهر Toast عند فشل Prev.

تأثير التجميل واضح بصريًا (فرق ملحوظ قبل/بعد).