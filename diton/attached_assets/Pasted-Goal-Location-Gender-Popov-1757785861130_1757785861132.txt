Goal

ØªØ·Ø¨ÙŠÙ‚ Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ÙƒÙ…Ø§ Ø§ØªÙ‘ÙÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§:

ğŸŒ Location Ùˆ âš§ Gender Ø£Ø¹Ù„Ù‰-ÙŠÙ…ÙŠÙ† Ø¨Ø¯Ø§Ø®Ù„ Popovers Ø®ÙÙŠÙØ©.
Location: Ø¹Ù…ÙˆØ¯Ø§Ù† + Ø£Ø¹Ù„Ø§Ù… + Ø¨Ø­Ø« + max-h-[60vh] ÙˆØªÙ…Ø±ÙŠØ±. Ø£ÙˆÙ„ Ø¹Ù†ØµØ± Ø¨Ù„Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø«Ù… All. ÙŠØ¸Ù‡Ø± Ø¹Ø¯Ù‘Ø§Ø¯ Ù…Ø®ØªØ§Ø±Ø§Øª.

Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø³ÙÙ„ÙŠ Ø«Ø§Ø¨Øª Ø¯Ø§Ø¦Ù…Ù‹Ø§ Ø¨Ø£Ø³ÙÙ„ Ø§Ù„Ø´Ø§Ø´Ø©. ØªØ±ØªÙŠØ¨ Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ† Ù„Ù„ÙŠØ³Ø§Ø±: ğŸ’¬, â¤, ğŸ”Š, ğŸ¤, â¸ï¸, âš™ï¸, ğŸ­, ğŸš©.

â­ï¸ ÙŠÙ…ÙŠÙ† ÙÙˆÙ‚ ğŸ’¬/â¤ Ùˆ**â®ï¸** ÙŠØ³Ø§Ø± ÙÙˆÙ‚ ğŸ­/ğŸš©. Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ÙƒØ¨ÙŠØ±Ø© Ø¨Ù„Ø§ ØµÙ†Ø§Ø¯ÙŠÙ‚. Ø«Ø§Ø¨ØªØ§Ù†. ÙˆØ¹Ù†Ø¯ ÙØªØ­ Ø´Ø±ÙŠØ· Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙŠÙØºØ·Ù‘ÙÙŠØ§Ù† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„.

Ø´Ø±ÙŠØ· Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙŠÙØªØ­ Ø¨Ø²Ø± ğŸ’¬ ÙÙ‚Ø·. Ø¨Ø¹Ø±Ø¶ ÙƒØ§Ù…Ù„. ÙŠÙ…ÙŠÙ†Ù‹Ø§ Ø²Ø± Ø¥Ø±Ø³Ø§Ù„ â¤ ÙˆÙŠØ³Ø§Ø±Ù‹Ø§ Ø²Ø± Ø¥ÙŠÙ…ÙˆØ¬ÙŠ ğŸ™‚ Ù…Ø¹ Ø¯Ø±Ø¬ Ø£ÙÙ‚ÙŠ Ø¯Ø§Ø®Ù„ Ù†ÙØ³ Ø§Ù„Ø­Ø§ÙˆÙŠØ©. ÙŠØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø¹Ø¨Ø± visualViewport.

Ù„Ø§ Ø±Ø³Ø§Ø¦Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ©.

HUD Ø±Ø³Ø§Ø¦Ù„: Ø¢Ø®Ø± 3 Ø³Ø·ÙˆØ± Ù†ØµÙŠØ© Ø¨Ù„Ø§ ØµÙ†Ø§Ø¯ÙŠÙ‚ØŒ Ø§Ù„ÙˆØ§Ø±Ø¯ â€¢ ÙˆØ§Ù„ØµØ§Ø¯Ø± â–²ØŒ Ù†Ø³Ø® Ø¨Ø§Ù„Ø¶ØºØ· Ø§Ù„Ù…Ø·ÙˆÙ‘Ù„.

ØªØ¬Ù…ÙŠÙ„ Ø§Ù„ÙˆØ¬Ù‡ Ù…ÙØ¹Ù‘Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­Ù„ÙŠ Ø¨Ù…Ø³ØªÙˆÙŠØ§Øª 0â€“3 Ø¹Ø¨Ø± ÙÙ„Ø§ØªØ± Ø®ÙÙŠÙØ©.

Ø·Ø¨Ù‚Ø§Øª Ø«Ø§Ø¨ØªØ©: toolbar z-60ØŒ messaging z-65ØŒ prev/next z-70.

Do

Ù†ÙÙ‘Ø° Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© ÙƒØ¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©. Ø£ÙŠ Ù…Ù„Ù Ù…Ø°ÙƒÙˆØ± â€œØ§Ø³ØªØ¨Ø¯Ø§Ù„ ÙƒØ§Ù…Ù„â€ ÙŠÙØ³ØªØ¨Ø¯Ù„ Ø¨Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø±ÙÙ‚.

1) FilterBar: popovers Ø®ÙÙŠÙØ©

Ø§Ø³ØªØ¨Ø¯Ø§Ù„ ÙƒØ§Ù…Ù„ src/app/chat/components/FilterBar.tsx:

"use client";
import { useEffect, useMemo, useState } from "react";
import { emit } from "@/utils/events";
import regionsData from "@/lib/regions"; // ÙŠÙØªÙˆÙ‚Ù‘Ø¹ export default [{code,name},...]
type GenderKey = "everyone"|"female"|"male"|"couples"|"lgbt";

function flagOf(cc:string){
  if(!cc) return "ğŸŒ";
  return cc.replace(/./g,c=>String.fromCodePoint(0x1f1e6+(c.toUpperCase().charCodeAt(0)-65)));
}

export default function FilterBar(){
  const [openLoc,setOpenLoc]=useState(false);
  const [openGen,setOpenGen]=useState(false);

  const [userCC,setUserCC]=useState<string|undefined>(undefined);
  const [countries,setCountries]=useState<string[]>(()=>JSON.parse(localStorage.getItem("ditona:filters:countries")||"[]"));
  const [genders,setGenders]=useState<GenderKey[]>(()=>JSON.parse(localStorage.getItem("ditona:filters:genders")||'["everyone"]'));

  useEffect(()=>{ // Ù…Ø­Ø§ÙˆÙ„Ø© Ù‚Ø±Ø§Ø¡Ø© Ø¨Ù„Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù† ÙˆÙØ¬Ø¯
    try{
      const g = JSON.parse(localStorage.getItem("ditona:geo")||"{}");
      if(g?.countryCode) setUserCC(g.countryCode);
    }catch{}
  },[]);
  useEffect(()=>{ localStorage.setItem("ditona:filters:countries",JSON.stringify(countries)); },[countries]);
  useEffect(()=>{ localStorage.setItem("ditona:filters:genders",JSON.stringify(genders)); },[genders]);

  const regions = useMemo(() => {
    const base = (regionsData || []) as Array<{code:string;name:string}>;
    const rest = base.filter(r => r.code !== userCC);
    const all = [
      ...(userCC ? base.filter(r=>r.code===userCC) : []),
      {code:"ALL", name:"All Countries"},
      ...rest.sort((a,b)=>a.name.localeCompare(b.name))
    ];
    return all;
  },[userCC]);

  const [q,setQ]=useState("");
  const view = regions.filter(r=>r.name.toLowerCase().includes(q.toLowerCase()) || r.code.toLowerCase().includes(q.toLowerCase()));

  const badgeCnt = countries.length>0 && !countries.includes("ALL") ? countries.length : 0;

  const toggleCountry=(cc:string)=>{
    if(cc==="ALL"){ setCountries(["ALL"]); return; }
    setCountries(prev=>{
      const base = (prev.includes("ALL") ? [] : prev).slice();
      const i = base.indexOf(cc);
      if(i>=0){ base.splice(i,1); return base; }
      if(base.length>=15) return base; // VIP cap Ù…Ø­ÙÙˆØ¸ Ù„Ø§Ø­Ù‚Ù‹Ø§
      base.push(cc); return base;
    });
  };

  const toggleGender=(g:GenderKey)=>{
    if(g==="everyone"){ setGenders(["everyone"]); return; }
    setGenders(prev=>{
      let base=prev.includes("everyone")?[]:[...prev];
      const i=base.indexOf(g);
      if(i>=0){ base.splice(i,1); if(base.length===0) base=["everyone"]; return base; }
      if(base.length>=2) return base;
      base.push(g); return base;
    });
  };

  return (
    <div className="absolute top-1 right-1 z-[80] flex gap-2 select-none">
      {/* Location button */}
      <div className="relative">
        <button data-ui="country-button"
          onClick={()=>{setOpenLoc(v=>!v); setOpenGen(false);}}
          className="h-9 px-3 rounded-full bg-black/40 text-white border border-white/15 backdrop-blur flex items-center gap-2">
          <span>ğŸŒ</span><span>Location</span>
          {badgeCnt>0 && <span className="ml-1 text-xs rounded-full bg-white/20 px-2 py-0.5">{badgeCnt}</span>}
        </button>
        {openLoc && (
          <div role="dialog" aria-label="Location"
               className="absolute mt-2 right-0 w-[min(92vw,640px)] max-h-[60vh] overflow-auto rounded-2xl border border-white/10 bg-zinc-900/95 backdrop-blur p-3 shadow-xl z-[90]"
               onKeyDown={(e)=>{ if(e.key==="Escape") setOpenLoc(false); }}>
            <div className="flex items-center gap-2 mb-3">
              <input value={q} onChange={e=>setQ(e.target.value)} placeholder="Search country"
                     className="w-full h-10 px-3 rounded-xl bg-zinc-800/70 text-white outline-none border border-white/10"/>
              <button onClick={()=>setOpenLoc(false)}
                      className="h-10 px-4 rounded-xl bg-white/10 text-white">Done</button>
            </div>
            <div className="grid grid-cols-2 gap-2">
              {view.map(r=>{
                const active = countries.includes("ALL") ? r.code==="ALL" : countries.includes(r.code);
                return (
                  <button key={r.code}
                          onClick={()=>toggleCountry(r.code)}
                          className={`flex items-center justify-between gap-3 rounded-xl px-3 py-2 text-left border ${active?'bg-indigo-600/20 border-indigo-400/40':'bg-white/5 border-white/10'} hover:bg-white/10`}>
                    <div className="flex items-center gap-3">
                      <span className="text-lg">{r.code==="ALL"?"ğŸŒ":flagOf(r.code)}</span>
                      <span className="text-white">{r.name}</span>
                    </div>
                    <span className="text-xs text-white/60">{r.code}</span>
                  </button>
                );
              })}
            </div>
          </div>
        )}
      </div>

      {/* Gender button */}
      <div className="relative">
        <button data-ui="gender-button"
          onClick={()=>{setOpenGen(v=>!v); setOpenLoc(false);}}
          className="h-9 px-3 rounded-full bg-black/40 text-white border border-white/15 backdrop-blur flex items-center gap-2">
          <span>âš§</span><span>Gender</span>
        </button>
        {openGen && (
          <div role="dialog" aria-label="Gender"
               className="absolute mt-2 right-0 w-[min(92vw,360px)] max-h-[60vh] overflow-auto rounded-2xl border border-white/10 bg-zinc-900/95 backdrop-blur p-3 shadow-xl z-[90]"
               onKeyDown={(e)=>{ if(e.key==="Escape") setOpenGen(false); }}>
            {([
              {k:"everyone",label:"Everyone",icon:"ğŸ‘¥"},
              {k:"female",label:"Female",icon:"â™€ï¸"},
              {k:"male",label:"Male",icon:"â™‚ï¸"},
              {k:"couples",label:"Couples",icon:"ğŸ‘«"},
              {k:"lgbt",label:"LGBT",icon:"ğŸ³ï¸â€ğŸŒˆ"},
            ] as Array<{k:GenderKey;label:string;icon:string}>).map(it=>{
              const active = genders.includes(it.k as GenderKey);
              return (
                <button key={it.k}
                        onClick={()=>toggleGender(it.k as GenderKey)}
                        className={`w-full flex items-center justify-between rounded-xl px-3 py-3 mb-2 border ${active?'bg-blue-600/25 border-blue-400/40':'bg-white/5 border-white/10'} hover:bg-white/10`}>
                  <span className="flex items-center gap-3">
                    <span className="text-lg">{it.icon}</span>
                    <span className="text-white">{it.label}</span>
                  </span>
                  {active && <span className="text-xs text-white/70">Selected</span>}
                </button>
              );
            })}
            <div className="text-xs text-white/50 mt-1">VIP users can select up to two genders.</div>
            <div className="mt-3 flex justify-end">
              <button onClick={()=>setOpenGen(false)} className="h-10 px-4 rounded-xl bg-white/10 text-white">Done</button>
            </div>
          </div>
        )}
      </div>
    </div>
  );
}


Ù…Ù„Ø§Ø­Ø¸Ø©: Ù†ØªÙˆÙ‚Ø¹ @/lib/regions Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§ (ÙƒÙ…Ø§ Ù‡Ùˆ Ø¨Ø§Ù„Ù…Ø´Ø±ÙˆØ¹). Ø¥Ù† ÙƒØ§Ù† Ø§Ø³Ù…Ù‡ Ù…Ø®ØªÙ„ÙÙ‹Ø§ØŒ Ø£Ø¹Ø¯ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„ÙØ¹Ù„ÙŠ Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯ÙˆÙ„.

2) ChatToolbar: ØªØ«Ø¨ÙŠØª Ø§Ù„Ø´Ø±ÙŠØ·ØŒ Ø²Ø±Ù‘Ø§ â®ï¸/â­ï¸ Ø¨Ù„Ø§ ØµÙ†Ø§Ø¯ÙŠÙ‚

Ø§Ø³ØªØ¨Ø¯Ø§Ù„ ÙƒØ§Ù…Ù„ src/app/chat/components/ChatToolbar.tsx:

"use client";
import { useState, useEffect } from "react";
import { emit } from "@/utils/events";

export default function ChatToolbar(){
  const [msgOpen,setMsgOpen]=useState(false);
  const [micOn,setMicOn]=useState(true);
  const [paused,setPaused]=useState(false);

  useEffect(()=>{ // sync with messaging bar
    const onOpen = ()=>setMsgOpen(true);
    const onClose= ()=>setMsgOpen(false);
    window.addEventListener("ui:openMessaging", onOpen as any);
    window.addEventListener("ui:closeMessaging", onClose as any);
    return ()=>{ window.removeEventListener("ui:openMessaging",onOpen as any); window.removeEventListener("ui:closeMessaging",onClose as any); };
  },[]);

  return (
    <>
      {/* Prev / Next icons large, no boxes */}
      <button data-ui="btn-prev" onClick={()=>emit("ui:prev")}
        className="fixed bottom-[calc(env(safe-area-inset-bottom)+88px)] left-2 sm:left-3 z-[70] text-3xl sm:text-4xl select-none">â®ï¸</button>
      <button data-ui="btn-next" onClick={()=>emit("ui:next")}
        className="fixed bottom-[calc(env(safe-area-inset-bottom)+88px)] right-2 sm:right-3 z-[70] text-3xl sm:text-4xl select-none">â­ï¸</button>

      {/* Bottom toolbar fixed forever */}
      <section className="pointer-events-auto fixed inset-x-2 sm:inset-x-4 z-[60]"
               style={{bottom: "calc(env(safe-area-inset-bottom) + 8px)"}}>
        <div className="relative flex flex-row-reverse items-center gap-2 sm:gap-3 justify-center">
          {/* ğŸ’¬ messages */}
          <button data-ui="btn-messages"
            onClick={()=>{ const ev = msgOpen?"ui:closeMessaging":"ui:openMessaging"; setMsgOpen(!msgOpen); emit(ev); }}
            aria-pressed={msgOpen}
            className={`w-10 h-10 sm:w-12 sm:h-12 rounded-lg border text-white ${msgOpen?'bg-purple-600/40 border-purple-400/60':'bg-black/20 border-white/20 hover:bg-white/10'}`}>ğŸ’¬</button>

          {/* â¤ like */}
          <button data-ui="btn-like" onClick={()=>emit("ui:like",{isLiked:true})}
            className="w-10 h-10 sm:w-12 sm:h-12 rounded-lg bg-pink-600/30 text-white border border-pink-400/40 hover:bg-pink-500/40">â¤</button>

          {/* ğŸ”Š remote audio */}
          <button data-ui="btn-remote-audio" onClick={()=>emit("ui:toggleRemoteAudio")}
            className="w-10 h-10 sm:w-12 sm:h-12 rounded-lg bg-black/20 text-white border border-white/20 hover:bg-white/10">ğŸ”Š</button>

          {/* ğŸ¤ mic */}
          <button data-ui="btn-mic"
            onClick={()=>{ setMicOn(v=>!v); emit("ui:toggleMic"); }}
            className={`w-10 h-10 sm:w-12 sm:h-12 rounded-lg text-white border ${micOn?'bg-green-600/30 border-green-400/40':'bg-red-600/30 border-red-400/40'}`}>{micOn?'ğŸ¤':'ğŸ”‡'}</button>

          {/* â¸ï¸ pause */}
          <button data-ui="btn-pause"
            onClick={()=>{ setPaused(v=>!v); emit("ui:togglePlay"); }}
            className={`w-10 h-10 sm:w-12 sm:h-12 rounded-lg text-white border ${paused?'bg-orange-600/30 border-orange-400/40':'bg-green-600/30 border-green-400/40'}`}>{paused?'â–¶ï¸':'â¸ï¸'}</button>

          {/* âš™ï¸ settings */}
          <button data-ui="btn-settings" onClick={()=>{ try{window.location.href='/settings'}catch{} }}
            className="w-10 h-10 sm:w-12 sm:h-12 rounded-lg bg-black/20 text-white border border-white/20 hover:bg-white/10">âš™ï¸</button>

          {/* ğŸ­ masks */}
          <button data-ui="btn-masks" onClick={()=>emit("ui:toggleMasks")}
            className="w-10 h-10 sm:w-12 sm:h-12 rounded-lg bg-black/20 text-white border border-white/20 hover:bg-white/10">ğŸ­</button>

          {/* ğŸš© report */}
          <button data-ui="btn-report" onClick={()=>emit("ui:report")}
            className="w-10 h-10 sm:w-12 sm:h-12 rounded-lg bg-red-600/30 text-white border border-red-400/40 hover:bg-red-500/40">ğŸš©</button>
        </div>
      </section>
    </>
  );
}

3) ChatMessagingBar: Ø¨Ø¹Ø±Ø¶ ÙƒØ§Ù…Ù„ØŒ Ù…Ø¹ Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ø¯Ø§Ø®Ù„ÙŠÙ‹Ø§

Ø§Ø³ØªØ¨Ø¯Ø§Ù„ ÙƒØ§Ù…Ù„ src/app/chat/components/ChatMessagingBar.tsx:

"use client";
import { useEffect, useRef, useState } from "react";
import { emit } from "@/utils/events";

const EMOJIS = ["ğŸ˜Š","ğŸ˜€","ğŸ˜˜","ğŸ¤©","â˜ºï¸","ğŸ˜‹","ğŸ¤ª","ğŸ˜œ","ğŸ¤—","ğŸ¤”","ğŸ«£","ğŸ˜","ğŸ˜´","ğŸ¤¤","ğŸ’‹","â¤ï¸","ğŸ’”","ğŸ’¯","ğŸ’¥","ğŸ’«","ğŸ’¬","ğŸ’¦","ğŸ‘","ğŸ«¦","ğŸ‘„","ğŸ‘…","ğŸ§–â€â™€ï¸","ğŸ”¥","ğŸ¥‚","ğŸŒ","ğŸŒ¹","ğŸ©±","ğŸ‘™","ğŸŒ¨","ğŸ›€","ğŸ"];

export default function ChatMessagingBar(){
  const [open,setOpen]=useState(false);
  const [text,setText]=useState("");
  const [showEmoji,setShowEmoji]=useState(false);
  const barRef = useRef<HTMLDivElement>(null);

  // open/close by toolbar
  useEffect(()=>{
    const onOpen = ()=>setOpen(true);
    const onClose= ()=>{ setOpen(false); setShowEmoji(false); };
    window.addEventListener("ui:openMessaging", onOpen as any);
    window.addEventListener("ui:closeMessaging", onClose as any);
    return ()=>{ window.removeEventListener("ui:openMessaging",onOpen as any); window.removeEventListener("ui:closeMessaging",onClose as any); };
  },[]);

  // keep above keyboard using visualViewport
  useEffect(()=>{
    const vv:any = (window as any).visualViewport;
    if(!vv) return;
    const handler=()=>{
      if(!barRef.current) return;
      const bottom = Math.max(8, (vv.height < window.innerHeight ? (window.innerHeight - vv.height + 8) : 8));
      barRef.current.style.bottom = `calc(env(safe-area-inset-bottom) + ${bottom}px)`;
    };
    vv.addEventListener("resize", handler);
    vv.addEventListener("scroll", handler);
    handler();
    return ()=>{ vv.removeEventListener("resize", handler); vv.removeEventListener("scroll", handler); };
  },[]);

  const send = ()=>{
    const t = text.trim();
    if(!t) return;
    emit("ui:sendMessage",{text:t});
    // HUD hook: ÙŠØ¨Ù‚Ù‰ Ù†ØµÙŠÙ‹Ø§ Ø¨Ù„Ø§ ØµÙ†Ø§Ø¯ÙŠÙ‚
    window.dispatchEvent(new CustomEvent("ditona:chat:sent",{detail:{text:t, ts:Date.now()}}));
    setText("");
  };

  if(!open) return null;

  return (
    <div ref={barRef} data-ui="messaging-bar"
         className="fixed left-0 right-0 z-[65] pointer-events-auto"
         style={{bottom:"calc(env(safe-area-inset-bottom)+8px)"}}>
      <div className="relative mx-2 sm:mx-4 rounded-2xl bg-black/45 backdrop-blur border border-white/15 px-3 py-2">
        {/* emoji drawer inside container */}
        {showEmoji && (
          <div className="absolute -top-14 left-0 right-0 mx-auto max-w-[min(92vw,640px)]">
            <div className="rounded-2xl bg-black/60 backdrop-blur border border-white/10 px-2 py-1 overflow-x-auto whitespace-nowrap">
              {EMOJIS.map(e=>(
                <button key={e} className="px-1.5 py-1 text-xl" onClick={()=>setText(t=>t+e)}>{e}</button>
              ))}
            </div>
          </div>
        )}

        <div className="flex items-center gap-2">
          {/* emoji toggle left */}
          <button aria-label="Emoji" onClick={()=>setShowEmoji(v=>!v)}
                  className="w-10 h-10 rounded-xl bg-white/10">ğŸ™‚</button>

          {/* input */}
          <input
            value={text}
            onChange={e=>setText(e.target.value)}
            onFocus={()=>setShowEmoji(false)}
            placeholder="Type your message here ..."
            className="flex-1 h-10 rounded-xl bg-zinc-800/70 text-white px-3 outline-none border border-white/10"/>

          {/* send on right */}
          <button aria-label="Send" onClick={send}
                  className="w-12 h-10 rounded-xl bg-emerald-600 text-white">â¤</button>
        </div>
      </div>
    </div>
  );
}

4) HUD Ù„Ø¢Ø®Ø± 3 Ø±Ø³Ø§Ø¦Ù„ ÙˆÙ…Ù†Ø¹ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©

Ø£Ø¶ÙÙ src/app/chat/components/MessageHud.tsx:

"use client";
import { useEffect, useState } from "react";

type Line = { text:string; ts:number; dir:"out"|"in" };

export default function MessageHud(){
  const [lines,setLines]=useState<Line[]>([]);
  useEffect(()=>{
    const add = (dir:"out"|"in") => (e:CustomEvent)=> setLines(l=>{
      const nxt=[...l,{text:(e.detail?.text||""), ts:Date.now(), dir}].slice(-3);
      return nxt;
    });
    const sent = add("out");
    const recv = add("in");
    window.addEventListener("ditona:chat:sent", sent as any);
    window.addEventListener("ditona:chat:recv", recv as any);
    return ()=>{ window.removeEventListener("ditona:chat:sent",sent as any); window.removeEventListener("ditona:chat:recv",recv as any); };
  },[]);
  if(lines.length===0) return null;
  return (
    <div className="pointer-events-none absolute inset-x-2 sm:inset-x-4 bottom-20 sm:bottom-24 z-[55] space-y-1">
      {lines.map((l,i)=>(
        <div key={i}
             onPointerDown={(e)=>{ e.preventDefault(); navigator.clipboard?.writeText(l.text).catch(()=>{}); }}
             className="text-white/90 drop-shadow-[0_1px_2px_rgba(0,0,0,0.8)] text-sm">
          <span className={l.dir==="in"?"text-white/80":"text-emerald-300"}>{l.dir==="in"?"â€¢ ":"â–² "}</span>
          {l.text}
        </div>
      ))}
    </div>
  );
}


Ø¹Ø¯Ù‘Ù„ src/app/chat/ChatClient.tsx: Ø£Ø¯Ø±Ø¬ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª ÙˆØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø£ÙŠ â€œMessageSystem/seedâ€.
Ø§Ø³ØªØ¨Ø¯Ù„ Ø§Ù„ÙƒØªÙ„Ø© Ø§Ù„ØªÙŠ ØªÙØ±ÙƒÙ‘ÙØ¨ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø³ÙÙ„ÙŠØ© Ø¨Ø­ÙŠØ« ØªØ´Ù…Ù„:

import FilterBar from "@/app/chat/components/FilterBar";
import ChatToolbar from "@/app/chat/components/ChatToolbar";
import ChatMessagingBar from "@/app/chat/components/ChatMessagingBar";
import MessageHud from "@/app/chat/components/MessageHud";
...
<div className="relative w-full h-full">
  {/* Ø£Ø¹Ù„Ù‰ ÙŠÙ…ÙŠÙ† */}
  <FilterBar />
  {/* HUD Ø¢Ø®Ø± 3 Ø±Ø³Ø§Ø¦Ù„ */}
  <MessageHud />
  {/* ... Ø¨Ù‚ÙŠØ© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ/Ø§Ù„Ø¹Ù†Ø§ØµØ± ... */}
  {/* Ø£Ø¯ÙˆØ§Øª Ø£Ø³ÙÙ„ + Ø´Ø±ÙŠØ· Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */}
  <ChatToolbar />
  <ChatMessagingBar />
</div>


ÙˆØ£Ø²Ù„ Ø£ÙŠ Ù…ÙƒÙˆÙ‘Ù† ÙŠÙˆÙ„Ù‘Ø¯ Ø±Ø³Ø§Ø¦Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ©.

Ø¥Ù† ÙˆÙØ¬Ø¯ Ø²Ø± â€œbeautyâ€ Ù‚Ø§Ø¦Ù…ØŒ Ø§Ø±Ø¨Ø·Ù‡ Ø¨Ø¥Ø·Ù„Ø§Ù‚ window.dispatchEvent(new CustomEvent("ditona:beauty",{detail:{level}})). Ø·Ø¨Ù‚Ø© Ø§Ù„ØªØ£Ø«ÙŠØ± ØªÙØ¶Ø§Ù Ù„Ø§Ø­Ù‚Ù‹Ø§ Ø¯ÙˆÙ† ÙƒØ³Ø±.

5) (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) ØªÙØ¹ÙŠÙ„ â€œØªØ¬Ù…ÙŠÙ„ Ø§Ù„ÙˆØ¬Ù‡â€ Ø§Ù„Ø¨Ø³ÙŠØ·

Ø£Ø¶ÙÙ src/app/chat/videoBeauty.ts (ØºÙŠØ± Ù…Ø¯Ù…ÙˆØ¬ Ø§Ù„Ø¢Ù† Ø¥Ù„Ø§ Ø¥Ù† ÙˆÙØ¬Ø¯ Ø²Ø± ÙŠØ·Ù„Ù‚ Ø§Ù„Ø­Ø¯Ø«):

"use client";
export function mountBeauty(el: HTMLElement){
  let level=0;
  const apply=()=>{
    const v = ["","contrast(1.05) brightness(1.05) saturate(1.05)",
      "contrast(1.1) brightness(1.08) saturate(1.1) blur(0.2px)",
      "contrast(1.15) brightness(1.1) saturate(1.15) blur(0.35px)"].at(level) as string;
    el.style.filter = v||"";
  };
  apply();
  const onEvt = (e:any)=>{ level = Math.max(0, Math.min(3, e?.detail?.level ?? 1)); apply(); };
  window.addEventListener("ditona:beauty", onEvt as any);
  return ()=> window.removeEventListener("ditona:beauty", onEvt as any);
}

6) Ø¥Ø®ÙØ§Ø¡ Queue badge Ø¥Ù† Ø¹Ø§Ø¯ Ø¸Ù‡ÙˆØ±Ù‡

ØªØ£ÙƒØ¯ ÙÙŠ ChatClient.tsx Ù…Ù† Ø¹Ø¯Ù… ØªØ±ÙƒÙŠØ¨ Ø£ÙŠ Ù…ÙƒÙˆÙ‘Ù† Queue Ø£Ø¹Ù„Ù‰-ÙŠÙ…ÙŠÙ†. Ø¥Ù† ÙˆÙØ¬Ø¯ØŒ Ø¹Ù„Ù‘Ù‚ ØªØ±ÙƒÙŠØ¨Ù‡.

7) Build & Tests

Ù†ÙÙ‘Ø°:

git checkout -b feat/ui-bottom-toolbar-final
pnpm -s build

# smoke UI markers
grep -Rns 'data-ui="country-button"' src/app/chat/components/FilterBar.tsx
grep -Rns 'data-ui="gender-button"'  src/app/chat/components/FilterBar.tsx
grep -Rns 'data-ui="btn-next"'       src/app/chat/components/ChatToolbar.tsx
grep -Rns 'data-ui="messaging-bar"'  src/app/chat/components/ChatMessagingBar.tsx

# acceptance (prod endpoints)
bash _ops/acc_rtc.sh https://www.ditonachat.com || true

Acceptance

Ø§Ù„Ø£Ø²Ø±Ø§Ø± Location/Gender ØªØ¹Ù…Ù„ Ø¹Ø¨Ø± Popovers Ø®ÙÙŠÙØ©ØŒ Location Ø¨Ø¹Ù…ÙˆØ¯ÙŠÙ† + Ø¨Ø­Ø« + max-h-[60vh] ÙˆØªÙ…Ø±ÙŠØ±ØŒ ÙˆÙŠØ¸Ù‡Ø± Ø¹Ø¯Ù‘Ø§Ø¯ Ù…Ø®ØªØ§Ø±Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±.

Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ Ø«Ø§Ø¨Øª Ø¯Ø§Ø¦Ù…Ù‹Ø§ Ø£Ø³ÙÙ„ Ø§Ù„Ø´Ø§Ø´Ø©.

â­ï¸ ÙŠÙ…ÙŠÙ† Ùˆâ®ï¸ ÙŠØ³Ø§Ø± ÙÙˆÙ‚ Ø§Ù„Ø´Ø±ÙŠØ· Ø¨Ù„Ø§ ØµÙ†Ø§Ø¯ÙŠÙ‚ ÙˆØ¨Ø­Ø¬Ù… ÙƒØ¨ÙŠØ±.

ÙØªØ­ Ø´Ø±ÙŠØ· Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙŠØºØ·ÙŠ â­ï¸/â®ï¸.

Ù„Ø§ Ø±Ø³Ø§Ø¦Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ©. HUD ÙŠØ¹Ø±Ø¶ Ø¢Ø®Ø± 3 Ø±Ø³Ø§Ø¦Ù„ ÙÙ‚Ø·ØŒ ÙˆÙ†Ø³Ø® Ø¨Ø§Ù„Ø¶ØºØ· Ø§Ù„Ù…Ø·ÙˆÙ‘Ù„ ÙŠØ¹Ù…Ù„.

Ø§Ù„Ø¨Ù†Ø§Ø¡ ÙŠÙ…Ø±Ù‘ Ø¨Ù„Ø§ Ø£Ø®Ø·Ø§Ø¡.

ØªÙ‚Ø±ÙŠØ± Ù…Ø®ØªØµØ± Ø¨Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø¹Ø¯Ù‘Ù„Ø© ÙˆØµÙˆØ± Ø´Ø§Ø´Ø© Ù…Ù† /chat Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„.